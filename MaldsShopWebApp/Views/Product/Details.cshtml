@using MaldsShopWebApp.ViewModels
@model DetailsProductViewModel

@{
	bool isAuthenticated = User.Identity?.IsAuthenticated == true;
}

@{
	ViewData["Title"] = Model.Title;
}

<h2>Edit product</h2>

<div class="container mt-4">
	<div class="row">
		<div class="col-md-6">
			<img src="@Model.ImageUrl" class="img-fluid" alt="@Model.Title" />
		</div>

		<div class="col-md-6">
			<div class="row mb-2">
				<label class="col-sm-4 col-form-label">Product ID</label>
				<div class="col-sm-8">
					<input type="text" readonly class="form-control-plaintext" value="@Model.ProductId">
				</div>
			</div>

			<div class="row mb-2">
				<label class="col-sm-4 col-form-label">Title</label>
				<div class="col-sm-8">
					<h2>@Model.Title</h2>
				</div>
			</div>

			<div class="row mb-2">
				<label class="col-sm-4 col-form-label">Description</label>
				<div class="col-sm-8">
					<p class="lead">@Model.Description</p>
				</div>
			</div>

			<div class="row mb-2">
				<label class="col-sm-4 col-form-label">In Stock</label>
				<div class="col-sm-8">
					<p>@Model.InStock?.ToString() ?? " Not available"></p>
				</div>
			</div>

			<div class="row mb-2">
				<label class="col-sm-4 col-form-label">Price</label>
				<div class="col-sm-8">
					<input type="text" readonly class="form-control-plaintext" value="$@Model.Price">
				</div>
			</div>

			<div>
				<button type="button" class="btn btn-outline-primary" onclick="history.back();">
					Go Back
				</button>
				<button type="button" class="btn btn-outline-primary" onclick="history.back();">
					Add review
				</button>
				<button type="button" class="btn btn-outline-danger">
					To cart
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cart4" viewBox="0 0 16 16">
						<path d="M0 2.5A.5.5 0 0 1 .5 2H2a.5.5 0 0 1 .485.379L2.89 4H14.5a.5.5 0 0 1 .485.621l-1.5 6A.5.5 0 0 1 13 11H4a.5.5 0 0 1-.485-.379L1.61 3H.5a.5.5 0 0 1-.5-.5M3.14 5l.5 2H5V5zM6 5v2h2V5zm3 0v2h2V5zm3 0v2h1.36l.5-2zm1.11 3H12v2h.61zM11 8H9v2h2zM8 8H6v2h2zM5 8H3.89l.5 2H5zm0 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2m-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0m9-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2m-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0"></path>
					</svg>
				</button>
			</div>
			<br />
			<div>
				@{
					if (isAuthenticated)
					{
						<div>
							<a asp-controller="Product" asp-action="Edit" asp-route-id="@Model.ProductId" type="button" class="btn btn-outline-primary">
								Edit
							</a>
							<a asp-controller="Product" asp-action="Delete" asp-route-id="@Model.ProductId" type="button" class="btn btn-outline-danger">
								Delete
							</a>
						</div>
					}
				}
			</div>
		</div>

		<div class="row mt-4">
			<div class="col-12">
				<h4>Reviews</h4>
				@if (Model.Reviews != null && Model.Reviews.Any())
				{
					foreach (var review in Model.Reviews)
					{
						<div class="border p-2 mb-2">
							<p>Reviewed by user ID: @review.AppUserId</p>
							<p>@review.ReviewText</p>
							<p>Score: @review.ReviewScore</p>
							<p>Reviewed on: @review.AddedTime.ToString("g") @(review.EditedTime.HasValue ? $"(Edited: {review.EditedTime.Value.ToString("g")})" : "")</p>
						</div>
					}
				}
				else
				{
					<p>No reviews available.</p>
				}
			</div>
		</div>
	</div>
